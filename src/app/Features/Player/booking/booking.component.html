<div class="booking-container">
  <div class="nav-header">
    <div class="nav-content">
      <div class="logo-section">
        <svg width="40" height="40" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="40" cy="40" r="38" fill="#22C55E" stroke="#16A34A" stroke-width="2"/>
          <path d="M40 15C50 15 58 23 58 33C58 43 50 51 40 51C30 51 22 43 22 33C22 23 30 15 40 15Z" fill="white"/>
          <path d="M40 29C45 29 49 33 49 38C49 43 45 47 40 47C35 47 31 43 31 38C31 33 35 29 40 29Z" fill="#22C55E"/>
          <circle cx="40" cy="38" r="3" fill="white"/>
        </svg>
        <span class="logo-text">Football Booking</span>
      </div>
      <div class="user-section" *ngIf="currentUser$ | async as user">
        <span class="welcome-text">Welcome, {{ user.name }}!</span>
        <button class="logout-button" (click)="onLogout()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <polyline points="16,17 21,12 16,7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <line x1="21" y1="12" x2="9" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Logout
        </button>
      </div>
    </div>
  </div>

  <div class="booking-header">
    <button class="back-button" (click)="goBack()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span>Back to Fields</span>
    </button>
    <h1 class="page-title">Book Your Field</h1>
  </div>

  <div class="booking-content" *ngIf="selectedField">
    <div class="field-details-card">
      <div class="field-image-container">
        <img [src]="selectedField.url || 'assets/default-field-image.jpg'" [alt]="selectedField.name" class="field-image">
        <div class="field-overlay">
          <div class="rating-badge">
            <div class="stars">
              <!-- <svg *ngFor="let filled of getStarArray(selectedField.rating || 4.8)" 
                  [class.filled]="filled" 
                  width="16" height="16" 
                  viewBox="0 0 24 24" 
                  fill="none" 
                  xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" 
                      fill="currentColor"/>
              </svg> -->
            </div>
            <!-- <span class="rating-text">{{ selectedField.rating || '4.8' }}</span> -->
          </div>
        </div>
      </div>

      <div class="field-info">
        <div class="field-header">
          <h2 class="field-name">{{ selectedField.name }}</h2>
          <div class="price-display">
            <span class="currency">VND</span>
            <span class="price">{{ selectedField.price_per_hour | number:'1.0-0' }}</span>
            <span class="period">/hour</span>
          </div>
        </div>

        <!-- <p class="field-description">{{ selectedField.description || 'Description not available.' }}</p> -->

        <div class="field-details">
          <div class="detail-item">
            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21 10C21 17 12 23 12 23S3 17 3 10C3 5.02944 7.02944 1 12 1C16.9706 1 21 5.02944 21 10Z" stroke="currentColor" stroke-width="2"/>
              <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
            </svg>
            <div class="detail-content">
              <span class="detail-label">Location</span>
              <span class="detail-value">{{ selectedField.address }}</span>
            </div>
          </div>

          <div class="detail-item">
            <svg class="detail-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
            </svg>
            <div class="detail-content">
              <span class="detail-label">Open Hours</span>
              <!-- <span class="detail-value">{{ selectedField.openHours || '06:00 AM - 11:00 PM' }}</span> -->
            </div>
          </div>
        </div>

        <div class="features-section">
          <h3 class="features-title">Facilities & Features</h3>
          <div class="features-grid">
            <!-- <span class="feature-tag" *ngFor="let feature of selectedField.features || ['Floodlights', 'Parking', 'Refreshments']">
              <svg class="feature-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              {{ feature }}
            </span> -->
          </div>
        </div>
      </div>
    </div>

    <div class="booking-form-card">
      <div class="form-header">
        <h3 class="form-title">Book This Field</h3>
        <p class="form-subtitle">Fill in your details to secure your booking</p>
      </div>

      <form [formGroup]="bookingForm" (ngSubmit)="onSubmit()" class="booking-form">
        <div class="form-group">
          <label for="date" class="form-label">
            <svg class="label-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
              <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
              <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
              <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
            </svg>
            Select Date
          </label>
          <input
            type="date"
            id="date"
            formControlName="date"
            class="form-input"
            [class.error]="bookingForm.get('date')?.invalid && bookingForm.get('date')?.touched"
          />
          <div class="error-message" *ngIf="bookingForm.get('date')?.invalid && bookingForm.get('date')?.touched">
            <span *ngIf="bookingForm.get('date')?.errors?.['required']">Please select a date</span>
          </div>
        </div>

        <div class="form-group">
          <label for="timeSlot" class="form-label">
            <svg class="label-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
            </svg>
            Choose Time Slot
          </label>
          <select
            id="timeSlot"
            formControlName="timeSlot"
            class="form-select"
            [class.error]="bookingForm.get('timeSlot')?.invalid && bookingForm.get('timeSlot')?.touched"
          >
            <option value="" disabled>Select a time slot</option>
<option 
  *ngFor="let slot of availableTimeframes" 
  [value]="slot.id" 
  
  >
  {{ getTimeSlotLabel(slot.id) }} 

  </option>
          </select>
          <div class="error-message" *ngIf="bookingForm.get('timeSlot')?.invalid && bookingForm.get('timeSlot')?.touched">
            <span *ngIf="bookingForm.get('timeSlot')?.errors?.['required']">Please select a time slot</span>
          </div>
        </div>

        <div class="form-group">
          <label for="playerName" class="form-label">
            <svg class="label-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="currentColor" stroke-width="2"/>
              <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
            </svg>
            Full Name
          </label>
          <input
            type="text"
            id="playerName"
            formControlName="playerName"
            class="form-input"
            placeholder="Enter your full name"
            [class.error]="bookingForm.get('playerName')?.invalid && bookingForm.get('playerName')?.touched"
          />
          <div class="error-message" *ngIf="bookingForm.get('playerName')?.invalid && bookingForm.get('playerName')?.touched">
            <span *ngIf="bookingForm.get('playerName')?.errors?.['required']">Name is required</span>
            <span *ngIf="bookingForm.get('playerName')?.errors?.['minlength']">Name must be at least 2 characters</span>
          </div>
        </div>

        <div class="form-group">
          <label for="phoneNumber" class="form-label">
            <svg class="label-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M22 16.92V19.92C22 20.9 21.11 21.74 20.04 21.74C10.63 21.74 3 14.11 3 4.68C3 3.61 3.84 2.72 4.82 2.72H7.82C8.39 2.72 8.87 3.15 8.92 3.72L9.4 7.32C9.45 7.9 9.13 8.44 8.62 8.69L6.82 9.59C8.1 12.87 10.87 15.64 14.15 16.92L15.05 15.12C15.3 14.61 15.84 14.29 16.42 14.34L20.02 14.82C20.59 14.87 21.02 15.35 21.02 15.92V16.92H22Z" stroke="currentColor" stroke-width="2"/>
            </svg>
            Phone Number
          </label>
          <input
            type="tel"
            id="phoneNumber"
            formControlName="phoneNumber"
            class="form-input"
            placeholder="Enter your phone number"
            [class.error]="bookingForm.get('phoneNumber')?.invalid && bookingForm.get('phoneNumber')?.touched"
          />
          <div class="error-message" *ngIf="bookingForm.get('phoneNumber')?.invalid && bookingForm.get('phoneNumber')?.touched">
            <span *ngIf="bookingForm.get('phoneNumber')?.errors?.['required']">Phone number is required</span>
            <span *ngIf="bookingForm.get('phoneNumber')?.errors?.['pattern']">Please enter a valid phone number</span>
          </div>
        </div>

        <div class="form-group">
          <label for="specialRequests" class="form-label">
            <svg class="label-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2"/>
              <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
              <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2"/>
              <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2"/>
              <polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2"/>
            </svg>
            Special Requests (Optional)
          </label>
          <textarea
            id="specialRequests"
            formControlName="specialRequests"
            class="form-textarea"
            placeholder="Any special requirements or requests..."
            rows="3"
          ></textarea>
        </div>

        <div class="booking-summary">
          <h4 class="summary-title">Booking Summary</h4>
          <div class="summary-item">
            <span class="summary-label">Field:</span>
            <span class="summary-value">{{ selectedField.name }}</span>
          </div>
          <div class="summary-item" *ngIf="bookingForm.get('date')?.value">
            <span class="summary-label">Date:</span>
            <span class="summary-value">{{ bookingForm.get('date')?.value | date:'fullDate' }}</span>
          </div>
          <div class="summary-item" *ngIf="bookingForm.get('timeSlot')?.value">
            <span class="summary-label">Time:</span>
            <span class="summary-value">{{ getTimeSlotLabel(bookingForm.get('timeSlot')?.value) }}</span>
          </div>
          <div class="summary-item summary-total">
            <span class="summary-label">Total Price:</span>
            <span class="summary-value">VND {{ selectedField.price_per_hour | number:'1.0-0' }}</span>
          </div>
        </div>

        <button type="submit" class="confirm-button" [disabled]="bookingForm.invalid">
          <svg class="button-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span class="button-text">Confirm Booking</span>
        </button>
      </form>
    </div>
  </div>
</div>